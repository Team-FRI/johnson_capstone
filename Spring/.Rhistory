MR70 <- gam(AvgMax~ SiteLat, data = Data_merge_Model)
summary(MR70)
AIC(MR70) #322.29
MR71 <- gam(AvgMax~ SiteLon, data = Data_merge_Model)
summary(MR71)
AIC(MR71) #320.24
MR72 <- gam(PropLogL3~ SiteLat+SiteLon, data = Data_merge_Model)
summary(MR72)
AIC(MR72) #22.69
MR73 <- gam(PropLogL3~ SiteLat+SiteLon+Month, data = Data_merge_Model)
summary(MR73)
AIC(MR73) #-78.69
MR74 <- gam(PropLogL3~ SiteLat*SiteLon, data = Data_merge_Model)
summary(MR74)
AIC(MR74) #22.69
MR75 <- gam(PropLogL3~ SiteLat, data = Data_merge_Model)
summary(MR75)
AIC(MR75) #20.69
MR76 <- gam(PropLogL3~ SiteLon, data = Data_merge_Model)
summary(MR76)
AIC(MR76) #21.28
MR77 <- gam(PropLogL5~ SiteLat*SiteLon, data = Data_merge_Model)
summary(MR77)
AIC(MR77) #53.04
MR78 <- gam(PropLogL5~ SiteLat+SiteLon, data = Data_merge_Model)
summary(MR78)
AIC(MR78) #53.04
MR79 <- gam(PropLogL5~ SiteLat, data = Data_merge_Model)
summary(MR79)
AIC(MR79) #51.06
MR80 <- gam(PropLogL5~ SiteLon, data = Data_merge_Model)
summary(MR80)
AIC(MR80) #51.09
MR81 <- gam(PropLogG20~ SiteLat+SiteLon, data = Data_merge_Model)
summary(MR81)
AIC(MR81) #-623.42
#For MR81, Intercept and SiteLon are almost significant.
MR82 <- gam(PropLogL5~ SiteLat*SiteLon, data = Data_merge_Model)
summary(MR82)
AIC(MR82) #53.04
MR83 <- gam(PropLogL5~ SiteLat, data = Data_merge_Model)
summary(MR83)
AIC(MR83) #51.05
MR84 <- gam(PropLogL5~ SiteLon, data = Data_merge_Model)
summary(MR84)
AIC(MR84) #51.09
install.packages("readr")
install.packages("lubridate")
install.packages("mgcv")
install.packages("dplyr")
install.packages("mgcv")
install.packages("tidyverse")
install.packages("mgcv")
install.packages("tidyverse")
install.packages("mgcv")
install.packages("dplyr")
STPlot <- filter(ST,
(SiteCode == "Dry.Hoagland" & (Year == "2020" | Year == "2021")) |
(SiteCode == "Grandad.Hessler" & (Year == "2020" | Year == "2021")) |
(SiteCode == "Painter.LittleBear" & (Year == "2020" | Year == "2021")) |
(SiteCode == "Sherman.Loyalsock" & (Year == "2020" | Year == "2021")) |
(SiteCode == "Red.LittleBear" & (Year == "2020" | Year == "2021"))
)
ggplot(STPlot, aes(x = Year, y = Temp_C)) +
geom_line()
ggplot(STPlot, aes(x = Year, y = Temp_C, color = SiteCode)) +
geom_line() +
labs(x = "Year", y = "Temperature (°C)", color = "Site") +
theme_minimal()
ggplot(STPlot, aes(x = Date, y = Temp_C, color = SiteCode)) +
geom_line() +
labs(x = "Date", y = "Temperature (°C)", color = "Site") +
theme_minimal()
site_colors <- c("Dry.Hoagland" = "gray1", "Grandad.Hessler" = "blue", "Painter.LittleBear" = "forestgreen", "Sherman.Loyalsock" = "firebrick", "Red.LittleBear" = "slateblue2")
ggplot(STPlot, aes(x = Date, y = Temp_C, color = SiteCode)) +
geom_line() +
scale_color_manual(values = site_colors) +  # Apply custom color palette
labs(x = "Date", y = "Temperature (°C)", color = "Site") +
theme_minimal()
#Test
Data_merge_Model %>%
mutate(MP84 = predict.gam(MR84))  %>%
ggplot() +
geom_point(aes(SiteLon, PropLogL5)) +
geom_line(aes(SiteLon, MP84))
Data_merge_Model %>%
mutate(MP8 = predict.gam(MR8))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Count, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP8))
Data_merge_Model %>%
mutate(MP11 = predict.gam(MR11))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Count, color = Month)) +
geom_line(aes(AvgMin, MP11))
Data_merge_Model %>%
mutate(MP23 = predict.gam(MR23))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, RatAY, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP23))
Data_merge_Model %>%
mutate(MP28 = predict.gam(MR28))  %>%
ggplot() +
geom_point(aes(AvgMax, RatAY, color = Month)) +
geom_line(aes(AvgMax, MP28))
ggplot(Data_merge_Model, aes(x = AvgMax, y = RatAY, color = Month)) +
geom_point() +  # Scatter plot of actual data
geom_line(aes(y = MP28)) +  # Line plot of predicted values
labs(x = "Average Maximum Temperature", y = "RatAY", color = "Month") +
theme_minimal()
MP28 <- Data_merge_Model %>%
mutate(MP28 = predict(MR28))
ggplot(Data_merge_Model, aes(x = AvgMax, y = RatAY, color = Month)) +
geom_point() +  # Scatter plot of actual data
geom_line(aes(y = MP28)) +  # Line plot of predicted values
labs(x = "Average Maximum Temperature", y = "RatAY", color = "Month") +
theme_minimal()
View(MP28)
Data_merge_Model %>%
mutate(MP28 = predict.gam(MR28))  %>%
ggplot() +
geom_point(aes(AvgMax, RatAY, color = Month)) +
geom_line(aes(AvgMax, MP28))
ggplot(Data_merge_Model,aes(y=RatAy,x=AvgMax,color=factor(Month)))+geom_point()+stat_smooth(method="lm",se=FALSE)
ggplot(Data_merge_Model,aes(y=RatAY,x=AvgMax,color=factor(Month)))+geom_point()+stat_smooth(method="lm",se=FALSE)
ggplot(Data_merge_Model,aes(y=RatAY,x=AvgMax,color=factor(Month)))+geom_point()+stat_smooth(method="MR28",se=FALSE)
Data_merge_Model %>%
mutate(MP31 = predict.gam(MR31))  %>%
ggplot() +
geom_point(aes(AvgMin, RatAY, color = Month)) +
geom_line(aes(AvgMin, MP31))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_point(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_point(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_point(aes(Month, RatAY, color = PropLogL3)) +
geom_line(aes(Month, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_boxplot(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_line(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_line(aes(PropLogL3, RatAY, color = Month)) +
geom_point(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_line(aes(PropLogL3, RatAY, color = Month)) +
geom_boxplot(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_point(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP44 = predict.gam(MR44))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Biomass, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP44))
Data_merge_Model %>%
mutate(MP45 = predict.gam(MR45))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Biomass, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP45))
Data_merge_Model %>%
mutate(MP47 = predict.gam(MR47))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMin, MP45))
Data_merge_Model %>%
mutate(MP47 = predict.gam(MR47))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMin, MP47))
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMin*CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMin, MP50))
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMin, MP50))
Data_merge_Model %>%
mutate(MP49 = predict.gam(MR49))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP49))
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP50))
Data_merge_Model %>%
mutate(MP49 = predict.gam(MR49))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP49))
50
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP50))
MR52 <- gam(CPUE_Biomass ~ Month+PropLogL3, data = Data_merge_Model)
summary(MR52)
AIC(MR52) #680.19
Data_merge_Model %>%
mutate(MP52 = predict.gam(MR52))  %>%
ggplot() +
geom_point(aes(PropLogL3, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogL3, MP52))
MR53 <- gam(CPUE_Count ~ Month+PropLogL5, data = Data_merge_Model)
summary(MR53)
AIC(MR53) #378.06
Data_merge_Model %>%
mutate(MP53 = predict.gam(MR53))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogL5, MP53))
Data_merge_Model %>%
mutate(MP53 = predict.gam(MR53))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Count, color = Month)) +
geom_line(aes(PropLogL5, MP53))
Data_merge_Model %>%
mutate(MP53.1 = predict.gam(MR53.1))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogL5, MP53.1))
Data_merge_Model %>%
mutate(MP56 = predict.gam(MR56))  %>%
ggplot() +
geom_point(aes(PropLogG20, CPUE_Count, color = Month)) +
geom_line(aes(PropLogG20, MP56))
Data_merge_Model %>%
mutate(MP56.1 = predict.gam(MR56.1))  %>%
ggplot() +
geom_point(aes(PropLogG20, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogG20, MP56.1))
Data_merge_Model %>%
mutate(MP81 = predict.gam(MR81))  %>%
ggplot() +
geom_point(aes(PropLogG20, SiteLat, color = SiteLon)) +
geom_line(aes(PropLogG20, MP81))
Eggs <- STPlot %>%
filter(Month = 03 | Month = 04)
Eggs <- STPlot %>%
filter(Month = 3 | Month = 4) %>%
Eggs <- STPlot %>%
filter(Month == 3 | Month == 4) %>%
summarise(
min = min(Temp_C)
max = max(Temp_C)
Eggs <- STPlot %>%
filter(Month == 3 | Month == 4) %>%
summarise(
min = min(Temp_C),
max = max(Temp_C),
Avg = mean(Temp_C),
SD = sd(Temp_C)
)
View(Eggs)
Eggs <- STPlot %>%
filter(Month == 3 | Month == 4) %>%
summarise(
min = min(Temp_C, na.rm = TRUE),
max = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
View(Eggs)
Eggs <- STPlot %>%
filter(Month == 3 | Month == 4) %>%
summarise(
min = min(Temp_C, na.rm = TRUE),
max = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
detach("package:dplyr", unload = TRUE)
library(dplyr)
Eggs <- STPlot %>%
filter(Month == 3 | Month == 4) %>%
summarise(
min = min(Temp_C, na.rm = TRUE),
max = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
Eggs <- STPlot %>%
filter(Month == 03 | Month == 04) %>%
summarise(
min = min(Temp_C, na.rm = TRUE),
max = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
Eggs <- STPlot %>%
filter(Month == 03 | Month == 04) %>%
summarise(
min = min(Temp_C),
max = max(Temp_C),
Avg = mean(Temp_C),
SD = sd(Temp_C)
)
Eggs <- STPlot %>%
filter(Month == 03 | Month == 04) %>%
summarise(
min.1 = min(Temp_C, na.rm = TRUE),
max.1 = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
Eggs <- STPlot %>%
filter(Month == 04) %>%
summarise(
min = min(Temp_C, na.rm = TRUE),
max = max(Temp_C, na.rm = TRUE),
Avg = mean(Temp_C, na.rm = TRUE),
SD = sd(Temp_C, na.rm = TRUE)
)
Data_merge_Model %>%
mutate(MP8 = predict.gam(MR8))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Count, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP8))
Data_merge_Model %>%
mutate(MP11 = predict.gam(MR11))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Count, color = Month)) +
geom_line(aes(AvgMin, MP11))
Data_merge_Model %>%
mutate(MP11 = predict.gam(MR11)) %>%
ggplot() +
geom_boxplot(aes(x = AvgMin, y = CPUE_Count, fill = Month)) +
geom_point(aes(x = AvgMin, y = CPUE_Count, color = Month)) +
labs(x = "AvgMin", y = "CPUE_Count", title = "MP11") +
theme_minimal()
Data_merge_Model %>%
mutate(MP23 = predict.gam(MR23))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, RatAY, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP23))
Data_merge_Model %>%
mutate(MP23 = predict.gam(MR23))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, RatAY, color = SiteCode)) +
geom_line(aes(Lowest_Temperature_C, MP23))
Data_merge_Model %>%
mutate(MP28 = predict.gam(MR28))  %>%
ggplot() +
geom_point(aes(AvgMax, RatAY, color = Month)) +
geom_line(aes(AvgMax, MP28))
ggplot(Data_merge_Model,aes(y=RatAY,x=AvgMax,color=factor(Month)))+geom_point()+stat_smooth(method="MR28",se=FALSE)
ggplot(Data_merge_Model, aes(x = AvgMax, y = RatAY, color = Month)) +
geom_point() +  # Scatter plot of actual data
geom_line(aes(y = MP28)) +  # Line plot of predicted values
labs(x = "Average Maximum Temperature", y = "RatAY", color = "Month") +
theme_minimal()
Data_merge_Model %>%
mutate(MP28 = predict.gam(MR28))  %>%
ggplot() +
geom_point(aes(AvgMax, RatAY, color = Month)) +
geom_line(aes(AvgMax, MP28))
Data_merge_Model %>%
mutate(MP49 = predict.gam(MR49))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP49))
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP50))
Data_merge_Model %>%
mutate(MP28 = predict.gam(MR28))  %>%
ggplot() +
geom_point(aes(AvgMax, RatAY, color = Month)) +
geom_line(aes(AvgMax, MP28))
MP49 <- predict.gam(MR49)
MP49 <- predict.gam(MR49)
MP49 <- predict.gam(MR49)
MP49 %>%
ggplot(aes(AvgMax, fit)) + geom_smooth(Month)
MP49 <- fortify(MP49)
Data_merge_Model %>%
mutate(MP49 = predict.gam(MR49))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_smooth(aes(AvgMax, MP49))
Data_merge_Model %>%
mutate(MP31 = predict.gam(MR31))  %>%
ggplot() +
geom_point(aes(AvgMin, RatAY, color = Month)) +
geom_line(aes(AvgMin, MP31))
Data_merge_Model %>%
mutate(MP35 = predict.gam(MR35))  %>%
ggplot() +
geom_point(aes(PropLogL3, RatAY, color = Month)) +
geom_line(aes(PropLogL3, MP35))
Data_merge_Model %>%
mutate(MP45 = predict.gam(MR45))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Biomass, color = Month)) +
geom_line(aes(Lowest_Temperature_C, MP45))
Data_merge_Model %>%
mutate(MP45 = predict.gam(MR45))  %>%
ggplot() +
geom_point(aes(Lowest_Temperature_C, CPUE_Biomass, color = SiteCode)) +
geom_line(aes(Lowest_Temperature_C, MP45))
Data_merge_Model %>%
mutate(MP47 = predict.gam(MR47))  %>%
ggplot() +
geom_point(aes(AvgMin, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMin, MP47))
Data_merge_Model %>%
mutate(MP49 = predict.gam(MR49))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP49))
Data_merge_Model %>%
mutate(MP50 = predict.gam(MR50))  %>%
ggplot() +
geom_point(aes(AvgMax, CPUE_Biomass, color = Month)) +
geom_line(aes(AvgMax, MP50))
Data_merge_Model %>%
mutate(MP52 = predict.gam(MR52))  %>%
ggplot() +
geom_point(aes(PropLogL3, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogL3, MP52))
Data_merge_Model %>%
mutate(MP53 = predict.gam(MR53))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Count, color = Month)) +
geom_line(aes(PropLogL5, MP53))
Data_merge_Model %>%
mutate(MP53 = predict.gam(MR53))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Count, color = SiteCode)) +
geom_line(aes(PropLogL5, MP53))
Data_merge_Model %>%
mutate(MP53.1 = predict.gam(MR53.1))  %>%
ggplot() +
geom_point(aes(PropLogL5, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogL5, MP53.1))
Data_merge_Model %>%
mutate(MP56 = predict.gam(MR56))  %>%
ggplot() +
geom_point(aes(PropLogG20, CPUE_Count, color = Month)) +
geom_line(aes(PropLogG20, MP56))
Data_merge_Model %>%
mutate(MP56.1 = predict.gam(MR56.1))  %>%
ggplot() +
geom_point(aes(PropLogG20, CPUE_Biomass, color = Month)) +
geom_line(aes(PropLogG20, MP56.1))
Data_merge_Model %>%
mutate(MP81 = predict.gam(MR81))  %>%
ggplot() +
geom_point(aes(PropLogG20, SiteLat, color = SiteLon)) +
geom_line(aes(PropLogG20, MP81))
site_colors <- c("Dry.Hoagland" = "gray1", "Grandad.Hessler" = "blue", "Painter.LittleBear" = "forestgreen", "Sherman.Loyalsock" = "firebrick", "Red.LittleBear" = "slateblue2")
ggplot(STPlot, aes(x = Date, y = Temp_C, color = SiteCode)) +
geom_line() +
scale_color_manual(values = site_colors) +  # Apply custom color palette
labs(x = "Date", y = "Temperature (°C)", color = "Site") +
theme_minimal()
View(STPlot)
Eggs <- STPlot %>%
filter(Month == 03 | Month == 04) %>%
summarise(
min = min(Temp_C),
max = max(Temp_C),
Avg = mean(Temp_C),
SD = sd(Temp_C)
)
View(Eggs)
Eggs <- STPlot %>%
filter(Month == 03 | Month == 04)
View(Eggs)
Eggs <- STPlot %>%
filter(Month == "03" | Month == "04")
View(Eggs)
Eggs <- STPlot %>%
filter(Month == "03" | Month == "04") %>%
summarise(
min = min(Temp_C),
max = max(Temp_C),
Avg = mean(Temp_C),
SD = sd(Temp_C)
)
View(Eggs)
write.csv(Eggs, "Eggs.csv")
View(Eggs)
